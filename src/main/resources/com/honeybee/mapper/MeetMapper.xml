<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.honeybee.mapper.MeetMapper">

<select id="getList" resultType="com.honeybee.domain.MeetVO">
	<![CDATA[
		select
			MNO,
			CID,
			CID2,
			ID,
			TITLE,
			SMRY,
			to_char(CONTENT) AS CONTENT,
			STARTDT,
			ENDDT,
			RECSDT,
			RECEDT,
			RECNO,
			CURRNO,
			CNCLNO,
			HIT,
			THUMB,
			CHARGE,
			ONOFF,
			PLACE,
			LINK,
			IMG,
			REGDT,
			UPDDT,
			DELDT
			from MEET
			where mno >0
	]]>
</select>



<insert id="insert">
	insert into meet(
			MNO,
			CID,
			CID2,
			ID,
			TITLE,
			SMRY,
			CONTENT,
			STARTDT,
			ENDDT,
			RECSDT,
			RECEDT,
			RECNO,
			CURRNO,
			CNCLNO,
			HIT,
			THUMB,
			CHARGE,
			ONOFF,
			PLACE,
			LINK,
			IMG)
			values
			(
			SEQ_meet.nextval,
			#{cid},
			#{cid2},
			#{id},
			#{title},
			#{smry},
			#{content},
			#{startDt},
			#{endDt},
			#{recsDt},
			#{receDt},
			#{recNo},
			#{currNo},
			#{cnclNo},
			#{hit},
			#{thumb},
			#{charge},
			#{onoff},
			#{place},
			#{link},
			#{img}
			)
</insert>

<insert id="insertSelectKey">
	<selectKey keyProperty="mno" order="BEFORE" resultType="long">
		select seq_meet.nextval from dual
	</selectKey>

	insert into meet(MNO,
			CID,
			CID2,
			ID,
			TITLE,
			SMRY,
			CONTENT,
			STARTDT,
			ENDDT,
			RECSDT,
			RECEDT,
			RECNO,
			CURRNO,
			CNCLNO,
			HIT,
			THUMB,
			CHARGE,
			ONOFF,
			PLACE,
			LINK,
			IMG)
			values(
			#{mno},
			#{cid},
			#{cid2},
			#{id},
			#{title},
			#{smry},
			#{content},
			#{startDt},
			#{endDt},
			#{recsDt},
			#{receDt},
			#{recNo},
			#{currNo},
			#{cnclNo},
			#{hit},
			#{thumb},
			#{charge},
			#{onoff},
			#{place},
			#{link},
			#{img})
</insert>

<select id="read" resultType="com.honeybee.domain.MeetVO">
	select MNO,
			CID,
			CID2,
			ID,
			TITLE,
			SMRY,
			to_char(CONTENT) AS CONTENT,
			STARTDT,
			ENDDT,
			RECSDT,
			RECEDT,
			RECNO,
			CURRNO,
			CNCLNO,
			HIT,
			THUMB,
			CHARGE,
			ONOFF,
			PLACE,
			LINK,
			IMG,
			REGDT,
			UPDDT,
			DELDT
			from MEET
			where mno = #{mno}
</select>

<delete id="delete">
	delete from meet where mno = #{mno}
</delete>

<update id="update">
	update meet
	set
			TITLE = #{title},
			SMRY = #{smry},
			CONTENT = #{content},
			STARTDT = #{startDt},
			ENDDT = #{endDt},
			RECSDT = #{recsDt},
			RECEDT = #{receDt},
			RECNO = #{recNo},
			CHARGE = #{charge},
			ONOFF = #{onoff},
			PLACE = #{place},
			LINK = #{link},
			IMG = #{img},
			updDt = sysdate
	where mno = #{mno}
</update>

<select id="getMyList" resultType="com.honeybee.domain.MeetVO">
  <![CDATA[
    select
      MNO,
      CID,
      CID2,
      TITLE,
      SMRY,
      to_char(CONTENT) AS CONTENT,
      STARTDT,
      ENDDT,
      RECSDT,
      RECEDT,
      RECNO,
      CURRNO,
      CNCLNO,
      HIT,
      THUMB,
      CHARGE,
      ONOFF,
      PLACE,
      LINK,
      IMG,
      REGDT,
      UPDDT,
      DELDT
      from MEET
      where id = #{id}
  ]]>
</select>

<select id="getListWithPaging" resultType="com.honeybee.domain.MeetVO">
	<![CDATA[
		select
		  MNO,
	      CID,
	      CID2,
	      ID,
	      TITLE,
	      SMRY,
	      to_char(CONTENT) AS CONTENT,
	      STARTDT,
	      ENDDT,
	      RECSDT,
	      RECEDT,
	      RECNO,
	      CURRNO,
	      CNCLNO,
	      HIT,
	      THUMB,
	      CHARGE,
	      ONOFF,
	      PLACE,
	      LINK,
	      IMG,
	      REGDT,
	      UPDDT,
	      DELDT

	      from(
	      select /*+index_desc(meet meet_pk)*/
	      rownum rn,
	      MNO,
	      CID,
	      CID2,
	      ID,
	      TITLE,
	      SMRY,
	      to_char(CONTENT) AS CONTENT,
	      STARTDT,
	      ENDDT,
	      RECSDT,
	      RECEDT,
	      RECNO,
	      CURRNO,
	      CNCLNO,
	      HIT,
	      THUMB,
	      CHARGE,
	      ONOFF,
	      PLACE,
	      LINK,
	      IMG,
	      REGDT,
	      UPDDT,
	      DELDT
	      from meet where]]>

	      <trim prefix="(" suffix=") AND " prefixOverrides="OR">
	      	<foreach item='type' collection="typeArr">
	      	<trim prefix="OR">
	      		<choose>
	      			<when test="type == 'T'.toString()">
	      				title like '%'||#{keyword}||'%'
	      			</when>
	      			<when test="type =='C'.toString()">
	      				content like '%'||#{keyword}||'%'
	      			</when>
	      			<when test="type =='W'.toString()">
	      				id like '%'||#{keyword}||'%'
	      			</when>
	      		</choose>
	      	</trim>
	      	</foreach>
	      </trim>

	      <![CDATA[
	      rownum <= #{pageNum} * #{amount}
	      )

	      where rn > (#{pageNum}-1) * #{amount}
		  ]]>
</select>

<select id="getTotalCount" resultType="int">
	select count(*) from meet where mno > 0
</select>

<select id="getListTest" resultType="com.honeybee.domain.MeetVO">
  <![CDATA[
    select 
      MNO,
      CID,
      CID2,
      TITLE,
      SMRY,
      to_char(CONTENT) AS CONTENT,
      STARTDT,
      ENDDT,
      RECSDT,
      RECEDT,
      RECNO,
      CURRNO,
      CNCLNO,
      HIT,
      THUMB,
      CHARGE,
      ONOFF,
      PLACE,
      LINK,
      IMG,
      REGDT,
      UPDDT,
      DELDT
      from MEET
      where id = #{id}
  ]]>
</select>

<select id="getNick" resultType="com.honeybee.domain.CodeTableVO">
select code_table.cname from code_table, meet where (meet.cid=code_table.cid) and (id=#{id})
</select>


</mapper>
